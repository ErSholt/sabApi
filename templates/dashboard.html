<!DOCTYPE html>
<html lang="de" class="dark">
<head>
    <meta charset="UTF-8">
    <title>NZB Proxy Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { background-color: #1a1b26; color: #c0caf5; }</style>
</head>
<body class="p-6 max-w-6xl mx-auto font-sans">
    <div class="flex justify-between items-center mb-8 border-b border-gray-700 pb-4">
        <h1 class="text-3xl font-bold text-white">NZB Proxy <span class="text-blue-400">Dashboard</span></h1>
        <a href="/logout" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm">Logout</a>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="bg-gray-800 rounded-lg shadow-lg border border-gray-700 flex flex-col">
            <div class="bg-gray-700 px-6 py-3 font-bold text-white">Proxy History</div>
            <div class="flex-grow">
                <table class="w-full text-left text-sm">
                    <tbody class="divide-y divide-gray-700">
                        {% for log in request_log %}
                        <tr class="hover:bg-gray-700">
                            <td class="px-6 py-3 text-gray-400 text-xs">{{ log.time }}</td>
                            <td class="px-6 py-3 text-white truncate max-w-[200px]">{{ log.info }}</td>
                            <td class="px-6 py-3 text-right">
                                <span class="text-{{ 'green' if log.status == 200 else 'red' }}-400">{{ log.status }}</span>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="p-4 bg-gray-900 flex justify-between items-center text-xs">
                <a href="/?page_h={{ page_h - 1 }}&page_t={{ page_t }}" class="px-3 py-1 bg-gray-700 rounded {% if page_h <= 1 %}opacity-50 pointer-events-none{% endif %}">Zurück</a>
                <span>Seite {{ page_h }} von {{ total_h_pages }}</span>
                <a href="/?page_h={{ page_h + 1 }}&page_t={{ page_t }}" class="px-3 py-1 bg-gray-700 rounded {% if page_h >= total_h_pages %}opacity-50 pointer-events-none{% endif %}">Weiter</a>
            </div>
        </div>

        <div class="bg-gray-800 rounded-lg shadow-lg border border-gray-700 flex flex-col">
            <div class="bg-gray-700 px-6 py-3 font-bold text-white">Torbox Downloads</div>
            <div class="p-4 flex-grow space-y-3">
                {% if torbox_error %}<p class="text-red-400 text-sm">{{ torbox_error }}</p>{% endif %}
                {% for dl in torbox_downloads %}
                <div class="bg-gray-900 p-3 rounded border border-gray-700">
                    <div class="flex justify-between text-xs mb-1"><span class="truncate w-40 text-white">{{ dl.name }}</span><span class="text-blue-400">{{ dl.state }}</span></div>
                    <div class="w-full bg-gray-700 rounded-full h-1.5"><div class="bg-blue-500 h-1.5 rounded-full" style="width: {{ dl.progress }}%"></div></div>
                    <div class="flex justify-between text-[10px] text-gray-500 mt-1"><span>{{ dl.progress }}%</span><span>{{ dl.speed }}</span></div>
                </div>
                {% endfor %}
            </div>
            <div class="p-4 bg-gray-900 flex justify-between items-center text-xs">
                <a href="/?page_h={{ page_h }}&page_t={{ page_t - 1 }}" class="px-3 py-1 bg-gray-700 rounded {% if page_t <= 1 %}opacity-50 pointer-events-none{% endif %}">Zurück</a>
                <span>Seite {{ page_t }} von {{ total_t_pages }}</span>
                <a href="/?page_h={{ page_h }}&page_t={{ page_t + 1 }}" class="px-3 py-1 bg-gray-700 rounded {% if page_t >= total_t_pages %}opacity-50 pointer-events-none{% endif %}">Weiter</a>
            </div>
        </div>
    </div>
</body>
</html>